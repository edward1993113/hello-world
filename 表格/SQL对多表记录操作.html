<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>无标题文档</title>
</head>

<body>
<table width="100%" border="0">
  <tr>
    <td>SQL对多表记录操作</td>
    <td colspan="8">&nbsp;</td>
  </tr>
  <tr>
    <td rowspan="10">多表设计：</td>
    <td rowspan="6">正确分析表关系：</td>
    <td rowspan="2">一对多：在多的一方创建一个字段,这个字段作为外键指向一的一方的主键</td>
    <td colspan="6">客户和订单：一个客户可以产生多个订单,一个订单只能属于是某一个客户.</td>
  </tr>
  <tr>
    <td colspan="6">部门和员工：一个部门下可以有多个员工,一个员工只能属于某一个部门.</td>
  </tr>
  <tr>
    <td rowspan="2">多对多: 创建一个中间表，中间表中至少需要两个字段分别作为外键指向多对多双方的各自的主键</td>
    <td colspan="6">学生和课程：一个学生可以选择多门课程,一门课程可以被多个学生选择.</td>
  </tr>
  <tr>
    <td colspan="6">订单和商品：一个订单中包含多个商品,一个商品也可以出现多个订单中.</td>
  </tr>
  <tr>
    <td rowspan="2">一对一：（很少）</td>
    <td>唯一外键对应：</td>
    <td colspan="5">假设一对一的双方是一对多的关系.在多的一方创建外键指向一的一方的主键.需要在外键上添加一个unique约束</td>
  </tr>
  <tr>
    <td>主键对应：</td>
    <td colspan="5">将一对一的双方的主键建立映射</td>
  </tr>
  <tr>
    <td>***** 约束：</td>
    <td colspan="7">用来保证数据的完整性.* 多表约束：外键约束！！！</td>
  </tr>
  <tr>
    <td>建表时添加外键：</td>
    <td colspan="7">直接在建表语句中添加 【constraint 外键名】foreign key （外键字段） references 表名（主键）</td>
  </tr>
  <tr>
    <td>外键的添加：</td>
    <td colspan="7">alter table xx add 【constraint 外键名】foreign key （外键字段） references 表名（主键）</td>
  </tr>
  <tr>
    <td>删除外键：</td>
    <td colspan="7">alter table drop foreign key 外键名</td>
  </tr>
  <tr>
    <td rowspan="8">多表查询：</td>
    <td colspan="3" rowspan="8">连接查询</td>
    <td colspan="5">笛卡尔积连接(交叉连接)select * from A , B ;</td>
  </tr>
  <tr>
    <td rowspan="2">内连接 :inner join -- inner 可以省略</td>
    <td>显式内连接</td>
    <td>select * from A inner join B on 条件;</td>
    <td>SELECT * FROM customer c INNER JOIN orders o ON c.cid = o.cid;</td>
    <td rowspan="2">查询的结果都是两个表的交集</td>
  </tr>
  <tr>
    <td>隐式内连接</td>
    <td>select * from A,B where 条件;</td>
    <td>SELECT * FROM customer c ,orders o WHERE c.cid = o.cid;</td>
  </tr>
  <tr>
    <td rowspan="4">外连接 :outer join -- outer 可以省略</td>
    <td rowspan="2">左外连接：</td>
    <td>left outer join  -- select * from A left outer join B on 条件;</td>
    <td>SELECT * FROM customer c LEFT OUTER JOIN orders o ON c.cid = o.cid;</td>
    <td rowspan="4">查询的是主表中的所有以及从表中符合条件的数据,如果从表中没有数据的话,用 null 填充</td>
  </tr>
  <tr>
    <td colspan="2">查询的是左边表的全部和两个表的交集</td>
  </tr>
  <tr>
    <td rowspan="2">右外连接：</td>
    <td>right outer join -- select * from A right outer join B on 条件;</td>
    <td>SELECT * FROM customer c RIGHT OUTER JOIN orders o ON c.cid = o.cid;</td>
  </tr>
  <tr>
    <td colspan="2">查询的是右边表的全部和两个表的交集</td>
  </tr>
  <tr>
    <td colspan="5">子连接 :一个SQL需要依赖另一个SQL语句的查询结果</td>
  </tr>
</table>
</body>
</html>
